<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ecstasy AI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #141514;
    }
    ::-webkit-scrollbar {
      width: 6px;
    }
    ::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 3px;
    }
    .chat-bubble {
      transition: background 0.2s ease;
    }
    .chat-bubble:hover .copy-btn {
      opacity: 1;
    }
  </style>
</head>
<body class="text-white h-screen flex flex-col font-sans">

  <div id="chat" class="flex-1 overflow-y-auto px-6 py-6 space-y-4">
    <div class="bg-zinc-800 text-sm px-4 py-3 rounded-lg shadow chat-bubble relative border border-zinc-700 max-w-xl">
      <p>Hello! I'm <strong>Ecstasy AI</strong>,
        What would you like help with today?</p>
      <div class="text-xs text-gray-400 mt-2" id="init-time"></div>
    </div>
  </div>

  <div class="bg-zinc-900 border-t border-zinc-700 px-6 py-4">
    <div class="flex items-center gap-3">
      <textarea id="inputBox" rows="1" placeholder="Ask me about anything..." class="flex-1 resize-none bg-zinc-800 text-white border border-zinc-700 px-4 py-2 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-pink-400"></textarea>
      <button onclick="sendPrompt()" class="bg-pink-400 hover:bg-pink-500 p-2 rounded-md transition copy-btn">
        <svg class="w-5 h-5" fill="none" stroke="white" stroke-width="2" viewBox="0 0 24 24">
          <path d="M22 2L11 13" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    
  </div>

  <script>
    const chat = document.getElementById("chat");
    const inputBox = document.getElementById("inputBox");

    document.getElementById("init-time").textContent = getTime();

    inputBox.addEventListener("keydown", function (e) {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendPrompt();
      }
    });

    function getTime() {
      return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }

    async function sendPrompt() {
      const prompt = inputBox.value.trim();
      if (!prompt) return;

      const userBubble = document.createElement("div");
      userBubble.className = "bg-zinc-700 px-4 py-3 rounded-lg border border-zinc-600 max-w-xl chat-bubble";
      userBubble.innerHTML = `<p>${prompt.replace(/\n/g, "<br>")}</p><div class="text-xs text-gray-400 mt-2">${getTime()}</div>`;
      chat.appendChild(userBubble);
      chat.scrollTop = chat.scrollHeight;
      inputBox.value = "";

      const botBubble = document.createElement("div");
      botBubble.className = "bg-zinc-800 px-4 py-3 rounded-lg border border-zinc-700 max-w-xl chat-bubble relative";
      botBubble.innerHTML = `<p>Thinking...</p>`;
      chat.appendChild(botBubble);
      chat.scrollTop = chat.scrollHeight;

      try {
        const API_KEY = "AIzaSyBf1ly6NM9xUDyfVgZtttFYcaHNAIrvUNg"; 

        const payload = {
          contents: [{ parts: [{ text: prompt }] }],
          generationConfig: {
            maxOutputTokens: 512,
            temperature: 0.7,
            topP: 0.95
          },
          safetySettings: [
            { category: "HARM_CATEGORY_HARASSMENT", threshold: "BLOCK_NONE" },
            { category: "HARM_CATEGORY_HATE_SPEECH", threshold: "BLOCK_NONE" },
            { category: "HARM_CATEGORY_SEXUALLY_EXPLICIT", threshold: "BLOCK_NONE" },
            { category: "HARM_CATEGORY_DANGEROUS_CONTENT", threshold: "BLOCK_NONE" }
          ]
        };

        const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        const data = await res.json();
        if (!res.ok) throw new Error(data.error?.message || res.statusText);

        const reply = data?.candidates?.[0]?.content?.parts?.[0]?.text || "No response.";
        const isScript = /local\s+\w+|game:GetService/i.test(reply);

        if (isScript) {
          botBubble.innerHTML = `
            <button onclick="copyScript(this)" class="absolute top-2 right-2 text-xs bg-zinc-700 text-white px-2 py-1 rounded opacity-0 copy-btn">Copy</button>
            <pre class="text-sm text-green-400 font-mono whitespace-pre-wrap overflow-x-auto">${reply}</pre>
            <div class="text-xs text-gray-400 mt-2">${getTime()}</div>
          `;
        } else {
          botBubble.innerHTML = `
            <p>${reply.replace(/\n/g, "<br>")}</p>
            <div class="text-xs text-gray-400 mt-2">${getTime()}</div>
          `;
        }
      } catch (err) {
        botBubble.innerHTML = `<p class="text-red-400">Error: ${err.message}</p>`;
      }

      chat.scrollTop = chat.scrollHeight;
    }

    function copyScript(button) {
      const code = button.nextElementSibling.innerText;
      navigator.clipboard.writeText(code).then(() => {
        button.textContent = "Copied!";
        setTimeout(() => button.textContent = "Copy", 1500);
      });
    }
  </script>

</body>
</html>


